<!-- BY - PARAS DHIMAN -->
<!-- MIT LICENSE ‚óè Do Not Copy -->
<!-- SOFTWARELABS -->


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üåç GSID ‚Äî Global Intelligence Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'sans-serif'] },
          colors: {
            primary: '#4f46e5',
            secondary: '#10b981',
            danger: '#ef4444',
            warning: '#f59e0b'
          }
        }
      }
    }
  </script>
  <style>
    :root {
      --glass-bg: rgba(255, 255, 255, 0.08);
      --glass-border: rgba(255, 255, 255, 0.18);
      --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    }
    .dark {
      --glass-bg: rgba(30, 30, 40, 0.6);
      --glass-border: rgba(255, 255, 255, 0.1);
      --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    }
    .glass {
      background: var(--glass-bg);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid var(--glass-border);
      box-shadow: var(--glass-shadow);
      border-radius: 16px;
    }
    .spinner {
      width: 24px; height: 24px;
      border: 3px solid #374151;
      border-top: 3px solid #4f46e5;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #0f172a, #1e293b);
      color: #f1f5f9;
      margin: 0; padding: 0;
    }
    .country-flag { width: 28px; height: 20px; object-fit: cover; border-radius: 4px; }
    .fade-in { animation: fadeIn 0.5s ease forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body class="bg-gray-900 text-gray-100">
  <div id="app" class="min-h-screen p-4 md:p-6"></div>

  <script>
    // $$###$$
    const GNEWS_API_KEY = '2c54a1cba6fec4322a101abd10e3b514';
    // %%**%%
    
    // Cache
    const cache = new Map();
    const CACHE_TTL = 5 * 60 * 1000;

    async function cachedFetch(url, options = {}) {
      const now = Date.now();
      if (cache.has(url)) {
        const { data, timestamp } = cache.get(url);
        if (now - timestamp < CACHE_TTL) return data;
      }
      try {
        const res = await fetch(url, options);
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();
        cache.set(url, { data, timestamp: now });
        return data;
      } catch (err) {
        if (cache.has(url)) return cache.get(url).data;
        throw err;
      }
    }

    //  Build UI
    const app = document.getElementById('app');
    app.innerHTML = `
      <header class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
        <div>
          <h1 class="text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-emerald-400">üåê GSID Dashboard</h1>
          <p class="text-gray-400 text-sm">Real-time global intelligence ‚Äî weather, quakes, air, news & time</p>
        </div>
        <button id="themeToggle" class="px-4 py-2 glass rounded-lg flex items-center gap-2">üåô Dark</button>
      </header>

      <div id="errorBanner" class="hidden bg-red-900/30 border-l-4 border-red-500 p-4 mb-6">
        <div class="flex items-center">
          <span class="mr-2">‚ö†Ô∏è</span>
          <span id="errorMessage"></span>
        </div>
      </div>

      <!-- Map & Country Panel -->
      <section class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
        <div class="lg:col-span-2 glass p-5">
          <h2 class="font-semibold mb-4 flex items-center">
            <span>üåç World Intelligence Map</span>
            <span class="ml-2 text-xs bg-blue-900/20 px-2 py-0.5 rounded">Click a country</span>
          </h2>
          <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3">
            ${[
              { code: 'US', name: 'United States', flag: 'üá∫üá∏' },
              { code: 'IN', name: 'India', flag: 'üáÆüá≥' },
              { code: 'BR', name: 'Brazil', flag: 'üáßüá∑' },
              { code: 'DE', name: 'Germany', flag: 'üá©üá™' },
              { code: 'AU', name: 'Australia', flag: 'üá¶üá∫' },
              { code: 'JP', name: 'Japan', flag: 'üáØüáµ' },
              { code: 'ZA', name: 'South Africa', flag: 'üáøüá¶' },
              { code: 'CA', name: 'Canada', flag: 'üá®üá¶' },
              { code: 'FR', name: 'France', flag: 'üá´üá∑' },
              { code: 'MX', name: 'Mexico', flag: 'üá≤üáΩ' }
            ].map(c => `
              <button class="country-btn bg-gray-800 hover:bg-gray-700 p-3 rounded-lg flex flex-col items-center gap-1 text-sm transition ${c.code === 'US' ? 'ring-2 ring-blue-500' : ''}" data-code="${c.code}">
                <span class="text-lg">${c.flag}</span>
                <span>${c.code}</span>
              </button>
            `).join('')}
          </div>
          <p class="text-xs text-gray-500 mt-4 text-center">Tip: More countries can be added easily.</p>
        </div>

        <div id="countryPanel" class="glass p-5 hidden">
          <div class="flex items-start gap-3 mb-4">
            <img id="flagImg" src="" alt="Flag" class="w-16 h-12 object-cover rounded shadow">
            <div>
              <h2 id="countryName" class="text-xl font-bold"></h2>
              <p id="countrySub" class="text-gray-400"></p>
            </div>
          </div>
          <div id="countryDetails" class="space-y-2 text-sm grid grid-cols-2 gap-y-2"></div>
        </div>
      </section>

      <!-- Core Metrics -->
      <section id="coreMetrics" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
        <div class="glass p-5"><h3 class="font-semibold mb-3">üå¶ Weather</h3><div id="weatherCard" class="h-28 flex items-center justify-center">Select a country</div></div>
        <div class="glass p-5"><h3 class="font-semibold mb-3">üå¨ Air Quality</h3><div id="aqiCard" class="h-28 flex items-center justify-center">Select a country</div></div>
        <div class="glass p-5"><h3 class="font-semibold mb-3">‚è∞ Local Time</h3><div id="clockCard" class="space-y-1 text-sm h-28 flex flex-col justify-center">Select a country</div></div>
        <div class="glass p-5"><h3 class="font-semibold mb-3">üåç Earthquakes</h3><div id="eqCard" class="h-28 flex flex-col items-center justify-center"><div class="spinner"></div></div></div>
      </section>

      <!-- Charts -->
      <section id="chartSection" class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6 hidden">
        <div class="glass p-4 h-72">
          <h3 class="font-semibold mb-2">üå¨ Air Quality Forecast (12h)</h3>
          <canvas id="aqiChart" class="w-full h-full"></canvas>
        </div>
        <div class="glass p-4 h-72">
          <h3 class="font-semibold mb-2">üåç Recent Quakes (M ‚â• 4.5)</h3>
          <canvas id="eqChart" class="w-full h-full"></canvas>
        </div>
      </section>

      <!-- News -->
      <section class="glass p-5">
        <div class="flex justify-between items-center mb-4">
          <h3 class="font-semibold">üì∞ Global News Feed</h3>
          <span class="text-xs bg-blue-500 text-white px-2 py-1 rounded">GNews ‚Ä¢ Live</span>
        </div>
        <div id="newsGrid" class="grid grid-cols-1 md:grid-cols-2 gap-4">
          ${[...Array(4)].map(() => `
            <div class="bg-gray-800/20 p-3 rounded-lg animate-pulse">
              <div class="h-4 bg-gray-700 rounded w-3/4 mb-2"></div>
              <div class="h-3 bg-gray-700 rounded w-1/2"></div>
            </div>
          `).join('')}
        </div>
      </section>

      <footer class="mt-10 text-center text-gray-500 text-sm border-t border-gray-800 pt-6">
        <p>GSID ‚Äî Global Situation Intelligence Dashboard ‚Ä¢ All data from free public APIs</p>
        <p class="mt-1 text-xs">REST Countries ‚Ä¢ Open-Meteo ‚Ä¢ USGS ‚Ä¢ WorldTimeAPI ‚Ä¢ GNews</p>
      </footer>
    `;

    // üé® Theme Toggle
    const themeToggle = document.getElementById('themeToggle');
    let isDark = true;
    themeToggle.addEventListener('click', () => {
      isDark = !isDark;
      document.documentElement.classList.toggle('dark', isDark);
      themeToggle.innerHTML = isDark ? 'üåô Dark' : '‚òÄÔ∏è Light';
    });

    // üìä Charts
    let aqiChart = null;
    let eqChart = null;

    // üîÑ Load country data
    async function loadCountry(code) {
      // Update active button
      document.querySelectorAll('.country-btn').forEach(btn => btn.classList.remove('ring-2', 'ring-blue-500'));
      const activeBtn = document.querySelector(`.country-btn[data-code="${code}"]`);
      if (activeBtn) activeBtn.classList.add('ring-2', 'ring-blue-500');

      const countryPanel = document.getElementById('countryPanel');
      const weatherCard = document.getElementById('weatherCard');
      const aqiCard = document.getElementById('aqiCard');
      const clockCard = document.getElementById('clockCard');

      // Show loading
      weatherCard.innerHTML = '<div class="spinner"></div>';
      aqiCard.innerHTML = '<div class="spinner"></div>';
      clockCard.innerHTML = 'Loading...';
      countryPanel.classList.add('hidden');
      document.getElementById('errorBanner').classList.add('hidden');

      try {
        // ‚úÖ FIXED: Use /v3.1/alpha/{code} ‚Äî avoids 404
        const countryData = await cachedFetch(`https://restcountries.com/v3.1/alpha/${code}`);
        const country = countryData[0];

        // üèÅ Country Panel
        document.getElementById('flagImg').src = country.flags.svg || `https://flagcdn.com/w20/${code.toLowerCase()}.png`;
        document.getElementById('countryName').textContent = country.name.common;
        document.getElementById('countrySub').textContent = `${country.region} ‚Ä¢ ${country.subregion}`;
        
        const details = [
          { k: 'Capital', v: country.capital?.[0] || '‚Äî' },
          { k: 'Population', v: new Intl.NumberFormat().format(country.population) },
          { k: 'Area', v: `${country.area?.toLocaleString() || '‚Äî'} km¬≤` },
          { k: 'Languages', v: Object.values(country.languages || {}).join(', ') || '‚Äî' },
          { k: 'Currency', v: Object.values(country.currencies || {})[0]?.name || '‚Äî' },
          { k: 'Timezone', v: country.timezones?.[0] || 'UTC' }
        ];
        document.getElementById('countryDetails').innerHTML = details.map(d => `
          <div class="col-span-1"><span class="text-gray-400">${d.k}:</span></div>
          <div class="col-span-1 font-medium">${d.v}</div>
        `).join('');

        countryPanel.classList.remove('hidden');

        const lat = country.latlng[0];
        const lng = country.latlng[1];
        const tz = country.timezones?.[0] || 'UTC';

        // üå§ Weather (Open-Meteo)
        const weather = await cachedFetch(
          `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lng}&current_weather=true`
        );
        const w = weather.current_weather;
        weatherCard.innerHTML = `
          <div class="text-3xl font-bold">${Math.round(w.temperature)}¬∞C</div>
          <div class="text-sm mt-1">‚òÅÔ∏è ${w.weathercode} ‚Ä¢ üí® ${w.windspeed} km/h</div>
        `;

        // üå¨ Air Quality
        const aqiData = await cachedFetch(
          `https://air-quality-api.open-meteo.com/v1/air-quality?latitude=${lat}&longitude=${lng}&hourly=us_aqi&forecast_days=1`
        );
        const aqiVals = aqiData.hourly?.us_aqi || [];
        const latest = aqiVals.length ? Math.max(...aqiVals.slice(-3)) : 0;

        let level = '‚Äî', color = 'bg-gray-500', desc = 'No data';
        if (latest > 0) {
          if (latest <= 50) { level = 'Good'; color = 'bg-green-500'; desc = 'Air quality is satisfactory'; }
          else if (latest <= 100) { level = 'Moderate'; color = 'bg-yellow-500'; desc = 'Acceptable for most'; }
          else if (latest <= 150) { level = 'Unhealthy (SG)'; color = 'bg-orange-500'; }
          else if (latest <= 200) { level = 'Unhealthy'; color = 'bg-red-500'; }
          else { level = 'Hazardous'; color = 'bg-gray-800 border border-red-500'; }
        }

        aqiCard.innerHTML = `
          <div class="flex items-center gap-2 mb-1">
            <span class="px-2.5 py-1 text-xs font-bold ${color} text-white rounded">${level}</span>
            <span class="text-lg font-bold">AQI ${latest || '‚Äî'}</span>
          </div>
          <p class="text-xs text-gray-400">${latest > 0 ? desc : '‚Äî'}</p>
        `;

        // üìà AQI Chart
        if (aqiVals.length >= 6 && window.Chart) {
          const ctx = document.getElementById('aqiChart').getContext('2d');
          if (aqiChart) aqiChart.destroy();
          
          const labels = aqiData.hourly.time.slice(0, 12).map(t => new Date(t).getHours() + ':00');
          const data = aqiData.hourly.us_aqi.slice(0, 12);
          
          aqiChart = new Chart(ctx, {
            type: 'line',
             {
              labels,
              datasets: [{
                label: 'US AQI',
                 data,
                borderColor: data.map(v => 
                  v <= 50 ? '#10b981' : v <= 100 ? '#fbbf24' : v <= 150 ? '#f97316' : '#ef4444'
                ),
                borderWidth: 3,
                fill: false,
                tension: 0.3,
                pointRadius: 0,
                pointHoverRadius: 4
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: { legend: { display: false } },
              scales: {
                y: { 
                  beginAtZero: true,
                  ticks: { font: { size: 10 } }
                },
                x: { 
                  ticks: { font: { size: 9 } }
                }
              }
            }
          });
          document.getElementById('chartSection').classList.remove('hidden');
        }

        // ‚è∞ Live Clock (simulated ‚Äî real: use WorldTimeAPI)
        const updateClock = () => {
          const now = new Date();
          // Simulate offset: crude but works for demo
          const offset = tz.includes('+') ? parseFloat(tz.split('+')[1]) : 
                        tz.includes('-') ? -parseFloat(tz.split('-')[1]) : 0;
          const localTime = new Date(now.getTime() + offset * 3600 * 1000);
          clockCard.innerHTML = `
            <div class="text-2xl font-mono font-bold">${localTime.toLocaleTimeString('en-US', { hour12: false })}</div>
            <div class="text-sm text-gray-400 mt-1">${tz}</div>
          `;
        };
        updateClock();
        setInterval(updateClock, 1000);

      } catch (err) {
        console.error(`Country load error (${code}):`, err);
        const msg = err.message.includes('404') 
          ? `Country code "${code}" not found. Try another.` 
          : `Failed to load ${code}: ${err.message || 'Network error'}`;
        showError(msg);
      }
    }

    // üåç Global Data (EQ + News)
    async function loadGlobalData() {
      try {
        // üåç Earthquakes (USGS)
        const start = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
        const eqData = await cachedFetch(
          `https://earthquake.usgs.gov/fdsnws/event/1/query?format=geojson&starttime=${start}&minmagnitude=4.5`
        );
        const quakes = eqData.features || [];
        document.getElementById('eqCard').innerHTML = `
          <div class="text-3xl font-bold text-red-400">${quakes.length}</div>
          <p class="text-sm text-gray-400 mt-1">‚â•4.5M (last 7 days)</p>
          ${quakes.length ? `<p class="text-xs mt-1 truncate">${quakes[0]?.properties?.place || ''}</p>` : ''}
        `;

        // üìà EQ Chart
        if (quakes.length >= 3 && window.Chart) {
          const top10 = quakes.slice(0, 10);
          const mags = top10.map(q => q.properties.mag);
          const places = top10.map(q => q.properties.place.split(',')[0].substring(0, 12));
          
          const ctx = document.getElementById('eqChart').getContext('2d');
          if (eqChart) eqChart.destroy();
          
          eqChart = new Chart(ctx, {
            type: 'bar',
             {
              labels: places,
              datasets: [{
                label: 'Magnitude',
                 mags,
                backgroundColor: mags.map(m => 
                  m < 5 ? '#3b82f6' : m < 6 ? '#10b981' : m < 7 ? '#f59e0b' : '#ef4444'
                ),
                borderColor: '#0f172a',
                borderWidth: 1
              }]
            },
            options: {
              indexAxis: 'y',
              responsive: true,
              maintainAspectRatio: false,
              plugins: { legend: { display: false } },
              scales: {
                x: { 
                  beginAtZero: true,
                  max: Math.ceil(Math.max(...mags)) + 0.5,
                  ticks: { font: { size: 10 } }
                },
                y: { 
                  ticks: { font: { size: 9 } }
                }
              }
            }
          });
          document.getElementById('chartSection').classList.remove('hidden');
        }

        // üì∞ News ‚Äî GNews with YOUR KEY
        const newsData = await cachedFetch(
          `https://gnews.io/api/v4/top-headlines?token=${GNEWS_API_KEY}&lang=en&country=us&max=4`
        );
        const articles = newsData.articles || [];
        const newsHTML = articles.map(a => `
          <a href="${a.url}" target="_blank" rel="noopener noreferrer" class="news-item bg-gray-800/20 p-3 rounded-lg hover:bg-gray-700/30 transition group fade-in">
            <h4 class="font-medium line-clamp-2 group-hover:text-blue-300">${a.title}</h4>
            <p class="text-xs text-gray-400 mt-1">${a.source.name} ‚Ä¢ ${new Date(a.publishedAt).toLocaleDateString()}</p>
          </a>
        `).join('');
        
        document.getElementById('newsGrid').innerHTML = newsHTML || `
          <p class="text-amber-400 col-span-2 text-center py-4">‚ö†Ô∏è No news. Check API key.</p>
        `;

      } catch (err) {
        console.warn('Global data error:', err);
        document.getElementById('eqCard').innerHTML = '<span class="text-gray-500">‚Äî</span>';
        document.getElementById('newsGrid').innerHTML = `
          <p class="text-red-400 col-span-2 text-center py-4">‚ö†Ô∏è GNews Error: ${err.message || 'Invalid key?'}</p>
        `;
      }
    }

    // üö® Error Banner
    function showError(message) {
      document.getElementById('errorMessage').textContent = message;
      document.getElementById('errorBanner').classList.remove('hidden');
      setTimeout(() => document.getElementById('errorBanner').classList.add('hidden'), 8000);
    }

    // üöÄ Initialize
    document.querySelectorAll('.country-btn').forEach(btn => {
      btn.addEventListener('click', () => loadCountry(btn.dataset.code));
    });

    // Start with USA
    loadCountry('US');
    loadGlobalData();
    setInterval(loadGlobalData, 10 * 60 * 1000); // refresh every 10 min

    // Auto-hide spinner after initial load (fallback)
    setTimeout(() => {
      const spinners = document.querySelectorAll('.spinner');
      spinners.forEach(s => {
        if (s.parentElement && s.parentElement.textContent === '') {
          s.parentElement.innerHTML = '<span class="text-gray-500">‚Äî</span>';
        }
      });
    }, 5000);
  </script>
</body>
</html>

<!-- BY - PARAS DHIMAN-->
<!-- MIT LICENSE ‚óè DO NOT COPY ‚óè SoftwareLabs-->
<!-- VISIt: softwarelabs.lovable.app-->

<!-- For More Advanced Codes, Visit: https://github.com/Paras367/Advanced_Codes/ -->

<!-- BY - CyberVex(Paras Dhiman) -->
